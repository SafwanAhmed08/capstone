version: "3.1"

rules:
- rule: Lookup MITRE mitigation
  steps:
    - intent: ask_mitigation
    - action: action_lookup_mitigation

- rule: Lookup mitigation by ID
  steps:
    - intent: mitigation_id
    - action: action_lookup_mitigation

- rule: List available mitigations
  steps:
    - intent: list_mitigations
    - action: action_list_mitigations

- rule: Run anomaly detection when asked
  steps:
    - intent: threat_detection
    - action: action_run_anomaly_detection

- rule: Fallback with LLM
  steps:
  - intent: nlu_fallback
  - action: action_llm_fallback
  - action: utter_default